{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Vladi Gotsin\\\\Desktop\\\\react\\\\src\\\\Chess.js\",\n  _s = $RefreshSig$();\nimport { useState } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst DIM = 8; //8x8 Board\n\nclass Square extends Comment {\n  constructor(x, y, piece, color) {\n    this.x = x;\n    this.y = y;\n    this.piece = piece;\n    this.color = color;\n  }\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: 'chessSquare piece',\n      x: this.x,\n      y: this.y,\n      onClick: () => move(p, cl, x, y)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 18,\n      columnNumber: 16\n    }, this);\n  }\n}\nclass Board2 extends Comment {\n  constructor() {\n    this.position = [];\n    for (let i = 0; i < DIM; i++) {\n      this.position[i] = [];\n      for (let j = 0; j < DIM; j++) {\n        this.position[i].push(new Square(i, j));\n      }\n    }\n  }\n}\nfunction Board({\n  position,\n  move\n}) {\n  let color;\n  let piece;\n  let rows = [];\n  let key = 1;\n  let white = true;\n  let x = 0;\n  let y = 0;\n  for (let i = 0; i < position.length; i++) {\n    y = 0;\n    for (let j = 0; j < position[i].length; j++) {\n      if (position[i].charCodeAt(j) >= 97 && position[i].charCodeAt(j) <= 122) {\n        color = 'black';\n      } else if (position[i].charCodeAt(j) >= 65 && position[i].charCodeAt(j) <= 90) {\n        color = 'white';\n      } else {\n        color = undefined;\n      }\n      switch (position[i][j].toLowerCase()) {\n        case \"p\":\n          piece = 'pawn';\n          break;\n        case 'n':\n          piece = 'knight';\n          break;\n        case 'k':\n          piece = 'king';\n          break;\n        case 'q':\n          piece = 'queen';\n          break;\n        case 'b':\n          piece = 'bishop';\n          break;\n        case 'r':\n          piece = 'rook';\n          break;\n        default:\n          piece = undefined;\n          break;\n      }\n      if (piece != undefined && color != undefined) {\n        rows.push( /*#__PURE__*/_jsxDEV(Square, {\n          dark: white ? false : true,\n          piece: color + '-' + piece,\n          x: x,\n          y: y,\n          move: move\n        }, key, false, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 27\n        }, this));\n        if (key % 8 != 0) {\n          white = !white;\n        }\n        key++;\n        y++;\n      } else {\n        for (let k = 0; k < Number(position[i][j]); k++) {\n          rows.push( /*#__PURE__*/_jsxDEV(Square, {\n            dark: white ? false : true,\n            x: x,\n            y: y,\n            move: move\n          }, key, false, {\n            fileName: _jsxFileName,\n            lineNumber: 90,\n            columnNumber: 31\n          }, this));\n          if (key % 8 != 0) {\n            white = !white;\n          }\n          key++;\n          y++;\n        }\n      }\n    }\n    x++;\n  }\n  return rows;\n}\n_c = Board;\nexport default function Chess() {\n  _s();\n  const [boardPosition, setBoardPosition] = useState(['rnbqkbnr', 'pppppppp', '8', '8', '8', '8', 'PPPPPPPP', 'RNBQKBNR']);\n  const [selectedPiece, setSelectedPiece] = useState('');\n  const [oldX, setOldX] = useState('');\n  const [oldY, setOldY] = useState('');\n  const [allowedMoves, setAllowedMoves] = useState([]);\n  const [whiteToMove, setWhiteToMove] = useState(true);\n  const [canWhiteShortCastle, setCanWhiteShortCastle] = useState(true);\n  const [canWhiteLongCastle, setCanWhiteLongCastle] = useState(true);\n  const [canBlackShortCastle, setCanBlackShortCastle] = useState(true);\n  const [canBlackLongCastle, setCanBlackLongCastle] = useState(true);\n  const [isWhiteInCheck, setIsWhiteInCheck] = useState(false);\n  const [isBlackInCheck, setIsBlackInCheck] = useState(false);\n  function handleCapture(x, y, pieceToCapture) {\n    if (selectedPiece.charCodeAt(0) >= 65 && selectedPiece.charCodeAt(0) <= 90) {\n      if (pieceToCapture.charCodeAt(0) >= 65 && pieceToCapture.charCodeAt(0) <= 90) {\n        return;\n      }\n    }\n    if (selectedPiece.charCodeAt(0) >= 97 && selectedPiece.charCodeAt(0) <= 122) {\n      if (pieceToCapture.charCodeAt(0) >= 97 && pieceToCapture.charCodeAt(0) <= 122) {\n        return;\n      }\n    }\n    let oldRow = boardPosition[oldX];\n    let newRow = boardPosition[x];\n    oldRow = convertFenToString(oldRow);\n    newRow = convertFenToString(newRow);\n    oldRow = oldRow.substring(0, oldY) + ' ' + oldRow.substring(oldY + 1, oldRow.length);\n    newRow = newRow.substring(0, y) + selectedPiece + newRow.substring(y + 1, newRow.length);\n    oldRow = convertStringToFen(oldRow);\n    newRow = convertStringToFen(newRow);\n    let newBoard = [];\n    for (let i = 0; i < boardPosition.length; i++) {\n      if (i == x || i == oldX) {\n        if (x == oldX) {\n          //TO DO: Implement capturing on the same row\n          console.warn(\"Implement capturing on the same row\");\n        } else if (i == x) {\n          newBoard.push(newRow);\n        } else if (i == oldX) {\n          newBoard.push(oldRow);\n        }\n      } else {\n        newBoard.push(boardPosition[i]);\n      }\n    }\n    setBoardPosition(newBoard);\n    setWhiteToMove(!whiteToMove);\n  }\n  function convertFenToString(fen) {\n    let result = '';\n    for (let i = 0; i < fen.length; i++) {\n      if (fen.charCodeAt(i) >= 48 && fen.charCodeAt(i) <= 57) {\n        result += ' '.repeat(Number(fen[i]));\n      } else {\n        result += fen[i];\n      }\n    }\n    return result;\n  }\n  function convertStringToFen(str) {\n    for (let i = str.length - 1; i >= 0; i--) {\n      if (str[i] == ' ') {\n        if (i < str.length - 1) {\n          if (str.charCodeAt(i + 1) >= 48 && str.charCodeAt(i + 1) <= 57) {\n            str = str.substring(0, i) + (Number(str[i + 1]) + 1).toString() + str.substring(i + 1, str.length);\n            str = str.slice(0, i + 1) + str.slice(i + 2);\n          } else {\n            str = str.substring(0, i) + '1' + str.substring(i + 1, str.length);\n          }\n        } else {\n          str = str.substring(0, i) + '1' + str.substring(i + 1, str.length);\n        }\n      }\n    }\n    return str;\n  }\n  const Move = (p, c, x, y) => {\n    if (selectedPiece) {\n      //allows to deselect a piece\n      if (x == oldX) {\n        if (y == oldY) {\n          setSelectedPiece('');\n          setOldX('');\n          setOldY('');\n          return;\n        }\n      }\n\n      //allow only king moves if in check\n      //TO DO: Allow check blocks and attacking pieces captures\n      if (whiteToMove) {\n        if (isWhiteInCheck) {\n          if (p != 'k') {\n            setSelectedPiece('');\n            setOldX('');\n            setOldY('');\n            return;\n          }\n        }\n      } else {\n        if (isBlackInCheck) {\n          if (p != 'k') {\n            setSelectedPiece('');\n            setOldX('');\n            setOldY('');\n            return;\n          }\n        }\n      }\n      let row = boardPosition[x];\n      let newRow = '';\n      let oldRow = '';\n      let allowed = false;\n\n      //check if the move you're making is legal\n      for (let i = 0; i < allowedMoves.length; i++) {\n        let move = allowedMoves[i];\n        if (x == move[0]) {\n          if (y == move[1]) {\n            allowed = true;\n          }\n        }\n      }\n\n      //stop if illegal move is used\n      if (!allowed) {\n        setOldX('');\n        setOldY('');\n        setSelectedPiece('');\n        return;\n      }\n\n      //convert FEN to string, update the position and convert back to FEN\n      newRow = convertFenToString(row);\n      if (newRow[y] != ' ') {\n        handleCapture(x, y, newRow[y]);\n        setOldX('');\n        setOldY('');\n        setSelectedPiece('');\n        return;\n      }\n      newRow = newRow.substring(0, y) + selectedPiece + newRow.substring(y + 1, newRow.length);\n      newRow = convertStringToFen(newRow);\n\n      //get the old position; if same row, get the current new position\n      row = x == oldX ? newRow : boardPosition[oldX];\n\n      //convert FEN to string, update the old position and convert back to FEN\n      oldRow = convertFenToString(row);\n      oldRow = oldRow.substring(0, oldY) + ' ' + oldRow.substring(oldY + 1, oldRow.length);\n      oldRow = convertStringToFen(oldRow);\n\n      //create a new board position and update the board\n      let newBoard = [];\n      for (let i = 0; i < boardPosition.length; i++) {\n        if (i == x || i == oldX) {\n          //use the old position if it's the same row as the old position will be updating the current newPosition and will have the most up-to-date values\n          if (x == oldX) {\n            newBoard.push(oldRow);\n          } else if (i == x) {\n            newBoard.push(newRow);\n          } else if (i == oldX) {\n            newBoard.push(oldRow);\n          }\n        } else {\n          newBoard.push(boardPosition[i]);\n        }\n      }\n\n      //removes the right to castle if the rook has moved for white\n      if (selectedPiece == 'R') {\n        if (oldX == 7 && oldY == 0) {\n          setCanWhiteLongCastle(false);\n        }\n        if (oldX == 7 && oldY == 7) {\n          setCanWhiteShortCastle(false);\n        }\n      }\n\n      //removes the right to castle if the rook has moved for black\n      if (selectedPiece == 'r') {\n        if (oldX == 0 && oldY == 0) {\n          setCanBlackLongCastle(false);\n        }\n        if (oldX == 0 && oldY == 7) {\n          setCanBlackShortCastle(false);\n        }\n      }\n\n      //block castling when king moves for black\n      if (selectedPiece == 'k') {\n        setCanBlackLongCastle(false);\n        setCanBlackShortCastle(false);\n      }\n\n      //block castling when king moves for white\n      if (selectedPiece == 'K') {\n        setCanWhiteLongCastle(false);\n        setCanWhiteShortCastle(false);\n      }\n\n      //handle castling for white\n      if (selectedPiece == 'K') {\n        if (y - oldY == 2) {\n          let castleRow = newBoard[7];\n          castleRow = convertFenToString(castleRow);\n          castleRow = castleRow.substring(0, 5) + \"RK \";\n          castleRow = convertStringToFen(castleRow);\n          newBoard[7] = castleRow;\n        }\n        if (oldY - y == 2) {\n          let castleRow = newBoard[7];\n          castleRow = convertFenToString(castleRow);\n          castleRow = \"  KR \" + castleRow.substring(5, 8);\n          castleRow = convertStringToFen(castleRow);\n          newBoard[7] = castleRow;\n        }\n      }\n\n      //handle castling for black\n      if (selectedPiece == 'k') {\n        if (y - oldY == 2) {\n          let castleRow = newBoard[0];\n          castleRow = convertFenToString(castleRow);\n          castleRow = castleRow.substring(0, 5) + \"rk \";\n          castleRow = convertStringToFen(castleRow);\n          newBoard[0] = castleRow;\n        }\n        if (oldY - y == 2) {\n          let castleRow = newBoard[0];\n          castleRow = convertFenToString(castleRow);\n          castleRow = \"  kr \" + castleRow.substring(5, 8);\n          castleRow = convertStringToFen(castleRow);\n          newBoard[0] = castleRow;\n        }\n      }\n\n      //update the board and reset the variables\n      setBoardPosition(newBoard);\n      setOldX('');\n      setOldY('');\n      setSelectedPiece('');\n      setWhiteToMove(!whiteToMove);\n    } else {\n      if (c != whiteToMove) {\n        return;\n      }\n      switch (p) {\n        case \"p\":\n          let pawnMoves = [];\n          if (c) {\n            if (x == 6) {\n              pawnMoves.push([x - 1, y]);\n              pawnMoves.push([x - 2, y]);\n            } else {\n              pawnMoves.push([x - 1, y]);\n            }\n            if (x > 0) {\n              if (y > 0) {\n                let currentRowPosition = boardPosition[x - 1];\n                currentRowPosition = convertFenToString(currentRowPosition);\n                if (currentRowPosition[y - 1] != ' ') {\n                  pawnMoves.push([x - 1, y - 1]);\n                }\n              }\n              if (y < 8) {\n                let currentRowPosition = boardPosition[x - 1];\n                currentRowPosition = convertFenToString(currentRowPosition);\n                if (currentRowPosition[y + 1] != ' ') {\n                  pawnMoves.push([x - 1, y + 1]);\n                }\n              }\n            }\n          } else {\n            if (x == 1) {\n              pawnMoves.push([x + 1, y]);\n              pawnMoves.push([x + 2, y]);\n            } else {\n              pawnMoves.push([x + 1, y]);\n            }\n            if (x < 8) {\n              if (y > 0) {\n                let currentRowPosition = boardPosition[x + 1];\n                currentRowPosition = convertFenToString(currentRowPosition);\n                if (currentRowPosition[y - 1] != ' ') {\n                  pawnMoves.push([x + 1, y - 1]);\n                }\n              }\n              if (y < 8) {\n                let currentRowPosition = boardPosition[x + 1];\n                currentRowPosition = convertFenToString(currentRowPosition);\n                if (currentRowPosition[y + 1] != ' ') {\n                  pawnMoves.push([x + 1, y + 1]);\n                }\n              }\n            }\n          }\n          setAllowedMoves(pawnMoves);\n          break;\n        case \"r\":\n          let rookMoves = [];\n          for (let i = 0; i < 8; i++) {\n            rookMoves.push([i, y]);\n            rookMoves.push([x, i]);\n          }\n          setAllowedMoves(rookMoves);\n          break;\n        case \"n\":\n          let knightMoves = [];\n          if (x - 2 >= 0 && y - 1 >= 0) {\n            knightMoves.push([x - 2, y - 1]);\n          }\n          if (x - 2 >= 0 && y + 1 < 8) {\n            knightMoves.push([x - 2, y + 1]);\n          }\n          if (x + 2 < 8 && y - 1 >= 0) {\n            knightMoves.push([x + 2, y - 1]);\n          }\n          if (x + 2 < 8 && y + 1 < 8) {\n            knightMoves.push([x + 2, y + 1]);\n          }\n          if (x - 1 >= 0 && y - 2 >= 0) {\n            knightMoves.push([x - 1, y - 2]);\n          }\n          if (x + 1 < 8 && y - 2 >= 0) {\n            knightMoves.push([x + 1, y - 2]);\n          }\n          if (x - 1 >= 0 && y + 2 < 8) {\n            knightMoves.push([x - 1, y + 2]);\n          }\n          if (x + 1 < 8 && y + 2 < 8) {\n            knightMoves.push([x + 1, y + 2]);\n          }\n          setAllowedMoves(knightMoves);\n          break;\n        case \"b\":\n          let bishopMoves = [];\n          for (let i = 1; i <= 8; i++) {\n            if (x - i >= 0 && y - 1 >= 0) {\n              bishopMoves.push([x - i, y - i]);\n            }\n            if (x + 1 < 8 && y + i < 8) {\n              bishopMoves.push([x + i, y + i]);\n            }\n            if (x + 1 < 8 && y - 1 >= 0) {\n              bishopMoves.push([x + i, y - i]);\n            }\n            if (x - i >= 0 && y + 1 < 8) {\n              bishopMoves.push([x - i, y + i]);\n            }\n          }\n          setAllowedMoves(bishopMoves);\n          break;\n        case \"q\":\n          let queenMoves = [];\n          for (let i = 1; i <= 8; i++) {\n            if (x - i >= 0 && y - 1 >= 0) {\n              queenMoves.push([x - i, y - i]);\n            }\n            if (x + 1 < 8 && y + i < 8) {\n              queenMoves.push([x + i, y + i]);\n            }\n            if (x + 1 < 8 && y - 1 >= 0) {\n              queenMoves.push([x + i, y - i]);\n            }\n            if (x - i >= 0 && y + 1 < 8) {\n              queenMoves.push([x - i, y + i]);\n            }\n          }\n          for (let i = 0; i < 8; i++) {\n            queenMoves.push([i, y]);\n            queenMoves.push([x, i]);\n          }\n          setAllowedMoves(queenMoves);\n          break;\n        case \"k\":\n          let kingMoves = [];\n          for (let i = x - 1; i <= x + 1; i++) {\n            for (let j = y - 1; j <= y + 1; j++) {\n              //handle edges\n              if (i >= 0 && i < 8) {\n                if (j >= 0 && j < 8) {\n                  kingMoves.push([i, j]);\n                }\n              }\n            }\n          }\n\n          //handle castling\n          if (c) {\n            let lastRow = boardPosition[7];\n            lastRow = convertFenToString(lastRow);\n            if (canWhiteShortCastle) {\n              if (lastRow[5] == ' ' && lastRow[6] == ' ') {\n                kingMoves.push([x, y + 2]);\n              }\n            }\n            if (canWhiteLongCastle) {\n              if (lastRow[1] == ' ' && lastRow[2] == ' ' && lastRow[3] == ' ') {\n                kingMoves.push([x, y - 2]);\n              }\n            }\n          } else {\n            let firstRow = boardPosition[0];\n            firstRow = convertFenToString(firstRow);\n            if (canBlackShortCastle) {\n              if (firstRow[5] == ' ' && firstRow[6] == ' ') {\n                kingMoves.push([x, y + 2]);\n              }\n            }\n            if (canBlackLongCastle) {\n              if (firstRow[1] == ' ' && firstRow[2] == ' ' && firstRow[3] == ' ') {\n                kingMoves.push([x, y - 2]);\n              }\n            }\n          }\n          setAllowedMoves(kingMoves);\n          break;\n        default:\n          break;\n      }\n      if (p != undefined && c != undefined) {\n        p = c ? p.toUpperCase() : p;\n        setSelectedPiece(p);\n        setOldX(x);\n        setOldY(y);\n      }\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chessContainer\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"grid\",\n        className: \"chessGrid\",\n        children: /*#__PURE__*/_jsxDEV(Board, {\n          position: boardPosition,\n          move: Move\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 605,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 604,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 603,\n      columnNumber: 9\n    }, this)\n  }, void 0, false);\n}\n_s(Chess, \"IhlxSP5GS1lVgwjDIGSJHLPT3iM=\");\n_c2 = Chess;\nvar _c, _c2;\n$RefreshReg$(_c, \"Board\");\n$RefreshReg$(_c2, \"Chess\");","map":{"version":3,"names":["useState","jsxDEV","_jsxDEV","Fragment","_Fragment","DIM","Square","Comment","constructor","x","y","piece","color","render","className","onClick","move","p","cl","fileName","_jsxFileName","lineNumber","columnNumber","Board2","position","i","j","push","Board","rows","key","white","length","charCodeAt","undefined","toLowerCase","dark","k","Number","_c","Chess","_s","boardPosition","setBoardPosition","selectedPiece","setSelectedPiece","oldX","setOldX","oldY","setOldY","allowedMoves","setAllowedMoves","whiteToMove","setWhiteToMove","canWhiteShortCastle","setCanWhiteShortCastle","canWhiteLongCastle","setCanWhiteLongCastle","canBlackShortCastle","setCanBlackShortCastle","canBlackLongCastle","setCanBlackLongCastle","isWhiteInCheck","setIsWhiteInCheck","isBlackInCheck","setIsBlackInCheck","handleCapture","pieceToCapture","oldRow","newRow","convertFenToString","substring","convertStringToFen","newBoard","console","warn","fen","result","repeat","str","toString","slice","Move","c","row","allowed","castleRow","pawnMoves","currentRowPosition","rookMoves","knightMoves","bishopMoves","queenMoves","kingMoves","lastRow","firstRow","toUpperCase","children","id","_c2","$RefreshReg$"],"sources":["C:/Users/Vladi Gotsin/Desktop/react/src/Chess.js"],"sourcesContent":["import { useState } from \"react\";\r\n\r\nconst DIM = 8; //8x8 Board\r\n\r\nclass Square extends Comment {\r\n    constructor(x, y, piece, color) {\r\n        this.x = x\r\n        this.y = y\r\n        this.piece = piece\r\n        this.color = color\r\n    }\r\n\r\n    onClick = function () {\r\n        //TODO: Implement clicking a square\r\n    }\r\n\r\n    render() {\r\n        return <div className={'chessSquare piece'} x={this.x} y={this.y} onClick={() => move(p, cl, x, y)}></div>\r\n    }\r\n}\r\n\r\nclass Board2 extends Comment {\r\n    constructor() {\r\n        this.position = []\r\n\r\n        for (let i = 0; i < DIM; i++) {\r\n            this.position[i] = [];\r\n\r\n            for (let j = 0; j < DIM; j++) {\r\n                this.position[i].push(new Square(i, j))\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction Board({ position, move }) {\r\n\r\n    let color;\r\n    let piece;\r\n    let rows = [];\r\n    let key = 1;\r\n    let white = true;\r\n    let x = 0;\r\n    let y = 0;\r\n\r\n    for (let i = 0; i < position.length; i++) {\r\n        y = 0;\r\n        for (let j = 0; j < position[i].length; j++) {\r\n            if (position[i].charCodeAt(j) >= 97 && position[i].charCodeAt(j) <= 122) {\r\n                color = 'black';\r\n            } else if (position[i].charCodeAt(j) >= 65 && position[i].charCodeAt(j) <= 90) {\r\n                color = 'white';\r\n            } else {\r\n                color = undefined;\r\n            }\r\n\r\n            switch (position[i][j].toLowerCase()) {\r\n                case \"p\":\r\n                    piece = 'pawn';\r\n                    break;\r\n                case 'n':\r\n                    piece = 'knight';\r\n                    break;\r\n                case 'k':\r\n                    piece = 'king';\r\n                    break;\r\n                case 'q':\r\n                    piece = 'queen';\r\n                    break;\r\n                case 'b':\r\n                    piece = 'bishop';\r\n                    break;\r\n                case 'r':\r\n                    piece = 'rook';\r\n                    break;\r\n                default:\r\n                    piece = undefined;\r\n                    break;\r\n            }\r\n\r\n            if (piece != undefined && color != undefined) {\r\n                rows.push(<Square dark={white ? false : true} key={key} piece={color + '-' + piece} x={x} y={y} move={move}></Square>)\r\n                if (key % 8 != 0) {\r\n                    white = !white;\r\n                }\r\n                key++\r\n                y++;\r\n            } else {\r\n                for (let k = 0; k < Number(position[i][j]); k++) {\r\n                    rows.push(<Square dark={white ? false : true} key={key} x={x} y={y} move={move}></Square>)\r\n                    if (key % 8 != 0) {\r\n                        white = !white;\r\n                    }\r\n                    key++;\r\n                    y++\r\n                }\r\n            }\r\n        }\r\n        x++;\r\n    }\r\n\r\n    return rows;\r\n}\r\n\r\nexport default function Chess() {\r\n\r\n    const [boardPosition, setBoardPosition] = useState(\r\n        [\r\n            'rnbqkbnr',\r\n            'pppppppp',\r\n            '8',\r\n            '8',\r\n            '8',\r\n            '8',\r\n            'PPPPPPPP',\r\n            'RNBQKBNR'\r\n        ]);\r\n\r\n    const [selectedPiece, setSelectedPiece] = useState('');\r\n    const [oldX, setOldX] = useState('');\r\n    const [oldY, setOldY] = useState('');\r\n    const [allowedMoves, setAllowedMoves] = useState([])\r\n    const [whiteToMove, setWhiteToMove] = useState(true);\r\n    const [canWhiteShortCastle, setCanWhiteShortCastle] = useState(true);\r\n    const [canWhiteLongCastle, setCanWhiteLongCastle] = useState(true);\r\n    const [canBlackShortCastle, setCanBlackShortCastle] = useState(true);\r\n    const [canBlackLongCastle, setCanBlackLongCastle] = useState(true);\r\n    const [isWhiteInCheck, setIsWhiteInCheck] = useState(false);\r\n    const [isBlackInCheck, setIsBlackInCheck] = useState(false);\r\n\r\n    function handleCapture(x, y, pieceToCapture) {\r\n        if (selectedPiece.charCodeAt(0) >= 65 && selectedPiece.charCodeAt(0) <= 90) {\r\n            if (pieceToCapture.charCodeAt(0) >= 65 && pieceToCapture.charCodeAt(0) <= 90) {\r\n                return\r\n            }\r\n        }\r\n\r\n        if (selectedPiece.charCodeAt(0) >= 97 && selectedPiece.charCodeAt(0) <= 122) {\r\n            if (pieceToCapture.charCodeAt(0) >= 97 && pieceToCapture.charCodeAt(0) <= 122) {\r\n                return\r\n            }\r\n        }\r\n\r\n        let oldRow = boardPosition[oldX];\r\n        let newRow = boardPosition[x];\r\n\r\n        oldRow = convertFenToString(oldRow);\r\n        newRow = convertFenToString(newRow);\r\n\r\n        oldRow = oldRow.substring(0, oldY) + ' ' + oldRow.substring(oldY + 1, oldRow.length)\r\n        newRow = newRow.substring(0, y) + selectedPiece + newRow.substring(y + 1, newRow.length)\r\n\r\n        oldRow = convertStringToFen(oldRow)\r\n        newRow = convertStringToFen(newRow)\r\n\r\n        let newBoard = [];\r\n\r\n        for (let i = 0; i < boardPosition.length; i++) {\r\n            if (i == x || i == oldX) {\r\n                if (x == oldX) {\r\n                    //TO DO: Implement capturing on the same row\r\n                    console.warn(\"Implement capturing on the same row\")\r\n                }\r\n                else if (i == x) {\r\n                    newBoard.push(newRow);\r\n                } else if (i == oldX) {\r\n                    newBoard.push(oldRow);\r\n                }\r\n            } else {\r\n                newBoard.push(boardPosition[i]);\r\n            }\r\n        }\r\n\r\n        setBoardPosition(newBoard)\r\n        setWhiteToMove(!whiteToMove)\r\n    }\r\n\r\n    function convertFenToString(fen) {\r\n        let result = '';\r\n\r\n        for (let i = 0; i < fen.length; i++) {\r\n            if (fen.charCodeAt(i) >= 48 && fen.charCodeAt(i) <= 57) {\r\n                result += ' '.repeat(Number(fen[i]))\r\n            } else {\r\n                result += fen[i];\r\n            }\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    function convertStringToFen(str) {\r\n        for (let i = str.length - 1; i >= 0; i--) {\r\n            if (str[i] == ' ') {\r\n                if (i < str.length - 1) {\r\n                    if (str.charCodeAt(i + 1) >= 48 && str.charCodeAt(i + 1) <= 57) {\r\n                        str = str.substring(0, i) + (Number(str[i + 1]) + 1).toString() + str.substring(i + 1, str.length);\r\n                        str = str.slice(0, i + 1) + str.slice(i + 2);\r\n                    } else {\r\n                        str = str.substring(0, i) + '1' + str.substring(i + 1, str.length);\r\n                    }\r\n                } else {\r\n                    str = str.substring(0, i) + '1' + str.substring(i + 1, str.length);\r\n                }\r\n            }\r\n        }\r\n\r\n        return str;\r\n    }\r\n\r\n    const Move = (p, c, x, y) => {\r\n        if (selectedPiece) {\r\n\r\n            //allows to deselect a piece\r\n            if (x == oldX) {\r\n                if (y == oldY) {\r\n                    setSelectedPiece('')\r\n                    setOldX('')\r\n                    setOldY('')\r\n                    return\r\n                }\r\n            }\r\n\r\n            //allow only king moves if in check\r\n            //TO DO: Allow check blocks and attacking pieces captures\r\n            if (whiteToMove) {\r\n                if (isWhiteInCheck) {\r\n                    if (p != 'k') {\r\n                        setSelectedPiece('')\r\n                        setOldX('')\r\n                        setOldY('')\r\n                        return\r\n                    }\r\n                }\r\n            } else {\r\n                if (isBlackInCheck) {\r\n                    if (p != 'k') {\r\n                        setSelectedPiece('')\r\n                        setOldX('')\r\n                        setOldY('')\r\n                        return\r\n                    }\r\n                }\r\n            }\r\n\r\n            let row = boardPosition[x];\r\n            let newRow = '';\r\n            let oldRow = '';\r\n            let allowed = false;\r\n\r\n            //check if the move you're making is legal\r\n            for (let i = 0; i < allowedMoves.length; i++) {\r\n                let move = allowedMoves[i];\r\n\r\n                if (x == move[0]) {\r\n                    if (y == move[1]) {\r\n                        allowed = true;\r\n                    }\r\n                }\r\n            }\r\n\r\n            //stop if illegal move is used\r\n            if (!allowed) {\r\n                setOldX('')\r\n                setOldY('')\r\n                setSelectedPiece('')\r\n                return\r\n            }\r\n\r\n            //convert FEN to string, update the position and convert back to FEN\r\n            newRow = convertFenToString(row);\r\n\r\n            if (newRow[y] != ' ') {\r\n                handleCapture(x, y, newRow[y]);\r\n                setOldX('')\r\n                setOldY('')\r\n                setSelectedPiece('')\r\n                return;\r\n            }\r\n\r\n            newRow = newRow.substring(0, y) + selectedPiece + newRow.substring(y + 1, newRow.length);\r\n            newRow = convertStringToFen(newRow);\r\n\r\n            //get the old position; if same row, get the current new position\r\n            row = x == oldX ? newRow : boardPosition[oldX];\r\n\r\n            //convert FEN to string, update the old position and convert back to FEN\r\n            oldRow = convertFenToString(row);\r\n            oldRow = oldRow.substring(0, oldY) + ' ' + oldRow.substring(oldY + 1, oldRow.length);\r\n            oldRow = convertStringToFen(oldRow);\r\n\r\n            //create a new board position and update the board\r\n            let newBoard = [];\r\n\r\n            for (let i = 0; i < boardPosition.length; i++) {\r\n                if (i == x || i == oldX) {\r\n                    //use the old position if it's the same row as the old position will be updating the current newPosition and will have the most up-to-date values\r\n                    if (x == oldX) {\r\n                        newBoard.push(oldRow);\r\n                    }\r\n                    else if (i == x) {\r\n                        newBoard.push(newRow);\r\n                    } else if (i == oldX) {\r\n                        newBoard.push(oldRow);\r\n                    }\r\n                } else {\r\n                    newBoard.push(boardPosition[i]);\r\n                }\r\n            }\r\n\r\n            //removes the right to castle if the rook has moved for white\r\n            if (selectedPiece == 'R') {\r\n                if (oldX == 7 && oldY == 0) {\r\n                    setCanWhiteLongCastle(false)\r\n                }\r\n                if (oldX == 7 && oldY == 7) {\r\n                    setCanWhiteShortCastle(false)\r\n                }\r\n            }\r\n\r\n            //removes the right to castle if the rook has moved for black\r\n            if (selectedPiece == 'r') {\r\n                if (oldX == 0 && oldY == 0) {\r\n                    setCanBlackLongCastle(false)\r\n                }\r\n                if (oldX == 0 && oldY == 7) {\r\n                    setCanBlackShortCastle(false)\r\n                }\r\n            }\r\n\r\n            //block castling when king moves for black\r\n            if (selectedPiece == 'k') {\r\n                setCanBlackLongCastle(false)\r\n                setCanBlackShortCastle(false)\r\n            }\r\n\r\n            //block castling when king moves for white\r\n            if (selectedPiece == 'K') {\r\n                setCanWhiteLongCastle(false)\r\n                setCanWhiteShortCastle(false)\r\n            }\r\n\r\n            //handle castling for white\r\n            if (selectedPiece == 'K') {\r\n                if (y - oldY == 2) {\r\n                    let castleRow = newBoard[7];\r\n                    castleRow = convertFenToString(castleRow)\r\n                    castleRow = castleRow.substring(0, 5) + \"RK \"\r\n                    castleRow = convertStringToFen(castleRow)\r\n                    newBoard[7] = castleRow\r\n                }\r\n\r\n                if (oldY - y == 2) {\r\n                    let castleRow = newBoard[7];\r\n                    castleRow = convertFenToString(castleRow)\r\n                    castleRow = \"  KR \" + castleRow.substring(5, 8)\r\n                    castleRow = convertStringToFen(castleRow)\r\n                    newBoard[7] = castleRow\r\n                }\r\n            }\r\n\r\n            //handle castling for black\r\n            if (selectedPiece == 'k') {\r\n                if (y - oldY == 2) {\r\n                    let castleRow = newBoard[0];\r\n                    castleRow = convertFenToString(castleRow)\r\n                    castleRow = castleRow.substring(0, 5) + \"rk \"\r\n                    castleRow = convertStringToFen(castleRow)\r\n                    newBoard[0] = castleRow\r\n                }\r\n\r\n                if (oldY - y == 2) {\r\n                    let castleRow = newBoard[0];\r\n                    castleRow = convertFenToString(castleRow)\r\n                    castleRow = \"  kr \" + castleRow.substring(5, 8)\r\n                    castleRow = convertStringToFen(castleRow)\r\n                    newBoard[0] = castleRow\r\n                }\r\n            }\r\n\r\n            //update the board and reset the variables\r\n            setBoardPosition(newBoard);\r\n            setOldX('')\r\n            setOldY('')\r\n            setSelectedPiece('')\r\n\r\n            setWhiteToMove(!whiteToMove)\r\n        } else {\r\n            if (c != whiteToMove) {\r\n                return\r\n            }\r\n\r\n            switch (p) {\r\n                case \"p\":\r\n                    let pawnMoves = [];\r\n                    if (c) {\r\n                        if (x == 6) {\r\n                            pawnMoves.push([x - 1, y])\r\n                            pawnMoves.push([x - 2, y])\r\n                        } else {\r\n                            pawnMoves.push([x - 1, y])\r\n                        }\r\n\r\n                        if (x > 0) {\r\n                            if (y > 0) {\r\n                                let currentRowPosition = boardPosition[x - 1];\r\n                                currentRowPosition = convertFenToString(currentRowPosition);\r\n                                if (currentRowPosition[y - 1] != ' ') {\r\n                                    pawnMoves.push([x - 1, y - 1])\r\n                                }\r\n                            }\r\n\r\n                            if (y < 8) {\r\n                                let currentRowPosition = boardPosition[x - 1];\r\n                                currentRowPosition = convertFenToString(currentRowPosition);\r\n                                if (currentRowPosition[y + 1] != ' ') {\r\n                                    pawnMoves.push([x - 1, y + 1])\r\n                                }\r\n                            }\r\n                        }\r\n                    } else {\r\n                        if (x == 1) {\r\n                            pawnMoves.push([x + 1, y])\r\n                            pawnMoves.push([x + 2, y])\r\n                        } else {\r\n                            pawnMoves.push([x + 1, y])\r\n                        }\r\n\r\n                        if (x < 8) {\r\n                            if (y > 0) {\r\n                                let currentRowPosition = boardPosition[x + 1];\r\n                                currentRowPosition = convertFenToString(currentRowPosition);\r\n                                if (currentRowPosition[y - 1] != ' ') {\r\n                                    pawnMoves.push([x + 1, y - 1])\r\n                                }\r\n                            }\r\n\r\n                            if (y < 8) {\r\n                                let currentRowPosition = boardPosition[x + 1];\r\n                                currentRowPosition = convertFenToString(currentRowPosition);\r\n                                if (currentRowPosition[y + 1] != ' ') {\r\n                                    pawnMoves.push([x + 1, y + 1])\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    setAllowedMoves(pawnMoves)\r\n                    break;\r\n                case \"r\":\r\n                    let rookMoves = [];\r\n                    for (let i = 0; i < 8; i++) {\r\n                        rookMoves.push([i, y]);\r\n                        rookMoves.push([x, i]);\r\n                    }\r\n                    setAllowedMoves(rookMoves)\r\n                    break;\r\n                case \"n\":\r\n                    let knightMoves = [];\r\n\r\n                    if (x - 2 >= 0 && y - 1 >= 0) {\r\n                        knightMoves.push([x - 2, y - 1]);\r\n                    }\r\n\r\n                    if (x - 2 >= 0 && y + 1 < 8) {\r\n                        knightMoves.push([x - 2, y + 1]);\r\n                    }\r\n\r\n                    if (x + 2 < 8 && y - 1 >= 0) {\r\n                        knightMoves.push([x + 2, y - 1]);\r\n                    }\r\n\r\n                    if (x + 2 < 8 && y + 1 < 8) {\r\n                        knightMoves.push([x + 2, y + 1]);\r\n                    }\r\n\r\n                    if (x - 1 >= 0 && y - 2 >= 0) {\r\n                        knightMoves.push([x - 1, y - 2]);\r\n                    }\r\n\r\n                    if (x + 1 < 8 && y - 2 >= 0) {\r\n                        knightMoves.push([x + 1, y - 2]);\r\n                    }\r\n\r\n                    if (x - 1 >= 0 && y + 2 < 8) {\r\n                        knightMoves.push([x - 1, y + 2]);\r\n                    }\r\n\r\n                    if (x + 1 < 8 && y + 2 < 8) {\r\n                        knightMoves.push([x + 1, y + 2]);\r\n                    }\r\n\r\n                    setAllowedMoves(knightMoves)\r\n                    break;\r\n                case \"b\":\r\n                    let bishopMoves = [];\r\n                    for (let i = 1; i <= 8; i++) {\r\n                        if (x - i >= 0 && y - 1 >= 0) {\r\n                            bishopMoves.push([x - i, y - i]);\r\n                        }\r\n\r\n                        if (x + 1 < 8 && y + i < 8) {\r\n                            bishopMoves.push([x + i, y + i]);\r\n                        }\r\n\r\n                        if (x + 1 < 8 && y - 1 >= 0) {\r\n                            bishopMoves.push([x + i, y - i]);\r\n                        }\r\n\r\n                        if (x - i >= 0 && y + 1 < 8) {\r\n                            bishopMoves.push([x - i, y + i]);\r\n                        }\r\n                    }\r\n                    setAllowedMoves(bishopMoves);\r\n                    break;\r\n                case \"q\":\r\n                    let queenMoves = [];\r\n                    for (let i = 1; i <= 8; i++) {\r\n                        if (x - i >= 0 && y - 1 >= 0) {\r\n                            queenMoves.push([x - i, y - i]);\r\n                        }\r\n\r\n                        if (x + 1 < 8 && y + i < 8) {\r\n                            queenMoves.push([x + i, y + i]);\r\n                        }\r\n\r\n                        if (x + 1 < 8 && y - 1 >= 0) {\r\n                            queenMoves.push([x + i, y - i]);\r\n                        }\r\n\r\n                        if (x - i >= 0 && y + 1 < 8) {\r\n                            queenMoves.push([x - i, y + i]);\r\n                        }\r\n                    }\r\n                    for (let i = 0; i < 8; i++) {\r\n                        queenMoves.push([i, y]);\r\n                        queenMoves.push([x, i]);\r\n                    }\r\n                    setAllowedMoves(queenMoves)\r\n                    break;\r\n                case \"k\":\r\n                    let kingMoves = [];\r\n                    for (let i = x - 1; i <= x + 1; i++) {\r\n                        for (let j = y - 1; j <= y + 1; j++) {\r\n                            //handle edges\r\n                            if (i >= 0 && i < 8) {\r\n                                if (j >= 0 && j < 8) {\r\n                                    kingMoves.push([i, j]);\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    //handle castling\r\n                    if (c) {\r\n                        let lastRow = boardPosition[7]\r\n                        lastRow = convertFenToString(lastRow)\r\n                        if (canWhiteShortCastle) {\r\n                            if (lastRow[5] == ' ' && lastRow[6] == ' ') {\r\n                                kingMoves.push([x, y + 2])\r\n                            }\r\n                        }\r\n\r\n                        if (canWhiteLongCastle) {\r\n                            if (lastRow[1] == ' ' && lastRow[2] == ' ' && lastRow[3] == ' ') {\r\n                                kingMoves.push([x, y - 2]);\r\n                            }\r\n                        }\r\n                    } else {\r\n                        let firstRow = boardPosition[0]\r\n                        firstRow = convertFenToString(firstRow)\r\n\r\n                        if (canBlackShortCastle) {\r\n                            if (firstRow[5] == ' ' && firstRow[6] == ' ') {\r\n                                kingMoves.push([x, y + 2])\r\n                            }\r\n                        }\r\n\r\n                        if (canBlackLongCastle) {\r\n                            if (firstRow[1] == ' ' && firstRow[2] == ' ' && firstRow[3] == ' ') {\r\n                                kingMoves.push([x, y - 2]);\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    setAllowedMoves(kingMoves);\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n\r\n            if (p != undefined && c != undefined) {\r\n                p = c ? p.toUpperCase() : p;\r\n\r\n                setSelectedPiece(p);\r\n                setOldX(x);\r\n                setOldY(y);\r\n            }\r\n        }\r\n    }\r\n\r\n    return (<>\r\n        <div className=\"chessContainer\">\r\n            <div id=\"grid\" className=\"chessGrid\">\r\n                <Board position={boardPosition} move={Move}></Board>\r\n            </div>\r\n        </div>\r\n    </>)\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}